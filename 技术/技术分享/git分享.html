<!doctype html><html><head><title>git分享</title><base href="../../"><meta id="root-path" root-path="../../"><link rel="icon" sizes="96x96" href="https://publish-01.obsidian.md/access/f786db9fac45774fa4f0d8112e232d67/favicon-96x96.png"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=yes,minimum-scale=1,maximum-scale=5"><meta charset="UTF-8"><link rel="stylesheet" href="lib/styles/obsidian-styles.css"><link rel="stylesheet" href="lib/styles/theme.css"><link rel="stylesheet" href="lib/styles/plugin-styles.css"><link rel="stylesheet" href="lib/styles/snippets.css"><link rel="stylesheet" href="lib/styles/generated-styles.css"><style>body.css-settings-manager{--blur-depth:30px;--brightness-4-bg:1.5;--saturate-4-bg:2;--font-weight-strong:bold;--font-weight-h1:bold}body.theme-light.css-settings-manager{--background-waves-color:#312187;--print-h1-color:#000000;--print-h2-color:#000000;--print-h3-color:#000000;--print-h4-color:#000000;--print-h6-color:#000000;--print-h5-color:#000000}body.theme-dark.css-settings-manager{--background-waves-color:#312187;--print-h1-color:#FFFFFF;--print-h2-color:#FFFFFF;--print-h3-color:#FFFFFF;--print-h4-color:#FFFFFF;--print-h6-color:#FFFFFF;--print-h5-color:#FFFFFF}</style><script type="module" src="lib/scripts/graph_view.js"></script><script src="lib/scripts/graph_wasm.js"></script><script src="lib/scripts/tinycolor.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.2.4/pixi.min.js" integrity="sha512-Ch/O6kL8BqUwAfCF7Ie5SX1Hin+BJgYH4pNjRqXdTEqMsis1TUYg+j6nnI9uduPjGaj7DN4UKCZgpvoExt6dkw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="lib/scripts/webpage.js"></script><script src="lib/scripts/generated.js"></script></head><body class="mod-macos theme-light show-inline-title outliner-plugin-dnd minimal-things-dark colorful-active system-shade minimal-readable-off minimal-light-white panel-page-bg-theme-ligt-curve plugin-cm-show-whitespace obsidian-themepocalypse alx-folder-icons qe-title-right color-scheme-options-default background-settings-workplace-waves2-light background-settings-workplace-waves background-image-settings-markdown-page-default background-image-settings-markdown-page-random-default notebook-liked-markdown-page-grid-notebook-1 panel-page-bg-theme-dark-sea default-left-ribbon-style layout-style-options-default default-search-bar default-scrollbar bt-default-highlight h1-text-align-start h2-text-align-start h3-text-align-start h4-text-align-start h5-text-align-start h6-text-align-start default-hr bt-default-unordered-list default-ol-list-marker list-no-border file-shape-default file-name-non-wrapped remove-file-icons folder-style-change-options-colorful-default folder-colorful-one blockquote-style-default default-table table-width-100 table-style-default default-loading-page loading-text-typing-style rainbow-tag setting-style-traditional default-titlebar default-outline-style stack-tab-text-ori-mixed default-tab default-canvas-background traditional-callout-style style-options-for-admonition-plugin style-options-for-calendar-plugin-default style-options-for-kanban-plugin-static-default style-options-for-kanban-plugin-dynamic-default style-options-for-buttons-plugin dataview-list-style-pacman default-dvtable dialogue-style-default memos-default-light memos-default-dark quiet-outline-optimize code-theme-sublime whole-code-wrap codebox-default-style is-fullscreen loading"><div class="webpage-container"><div class="sidebar-left sidebar"><div class="sidebar-container"><div class="sidebar-sizer"><div class="sidebar-content-positioner"><div class="sidebar-content"><div><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="tree-container file-tree mod-nav-indicator" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Noteplan</span><button class="clickable-icon collapse-tree-button is-collapsed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area"><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">技术</span></a></div><div class="tree-item-children" style="display:none"><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title">技术分享</span></a></div><div class="tree-item-children" style="display:none"><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="技术/技术分享/git分享.html"><span class="tree-item-title">git分享</span></a></div><div class="tree-item-children"></div></div></div></div></div></div></div></div></div></div></div></div><div class="sidebar-gutter"><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div></div><div class="document-container show"><div class="markdown-preview-view markdown-rendered node-insert-event allow-fold-headings show-indentation-guide allow-fold-lists show-properties" style="tab-size:4"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section" style="min-height:21493.2px"><div class="markdown-preview-pusher" style="width:1px;height:.1px;margin-bottom:0"></div><div class="mod-header"><div class="inline-title" data-heading="git分享" id="git分享" style="display:block">git分享</div></div><div class="heading-wrapper"><h2 data-heading="底层结构" class="heading" id="底层结构"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>底层结构<div class="heading-after">...</div></h2><div class="heading-children"><div class="heading-wrapper"><h4 data-heading="逻辑结构" class="heading" id="逻辑结构"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>逻辑结构<div class="heading-after">...</div></h4><div class="heading-children"><div><ul><li data-line="0">工作区（working directory）当前版本所以文件，从版本库解压出来的文件，放入本地文件目录中。</li><li data-line="1">暂存区（staging area）包含的 git版本库中，主要保存了下一次提交次的文件系统，又称为 index 索引。</li><li data-line="2">版本库（git directory）git存储自己的元数据，以及文档数据库。<br><span width="800" alt="left" src="lib/media/pasted-image-20230921151940.png" class="internal-embed media-embed image-embed is-loaded"><img alt="left" src="lib/media/pasted-image-20230921151940.png" style="width:800px;max-width:100%"></span></li></ul></div></div></div><div class="heading-wrapper"><h4 data-heading="物理目录" class="heading" id="物理目录"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>物理目录<div class="heading-after">...</div></h4><div class="heading-children"><div><ul><li data-line="0">COMMIT_EDITMSG 最近一次提交时，commit变基信息</li><li data-line="1">FETCH_HEAD 当前所以分支 fetch 到的最新分支</li><li data-line="2">HEAD 指向当前的分支文件</li><li data-line="3">ORIG_HEAD 指向 merge、reset 等上次的提交</li><li data-line="4">REBASE_HEAD：变基信息，指向当前，被整合的commit的hashkey信息</li><li data-line="5">rebase-merge目录: 变基处理目录，完成之后删除</li><li data-line="6">config 用户当前仓库的配置<ul><li data-line="7">fetch = +refs/heads/<em>:refs/remotes/origin/</em> 表示同步refs/remotes/origin/<em> 下更新到 refs/heads/</em></li></ul></li><li data-line="8">description 用语 GitWeb 展示项目描述信息</li><li data-line="9">hooks 钩子</li><li data-line="10">index 暂存区文件，二进制文件</li><li data-line="11">info</li><li data-line="12">log 保存记录变更信息<ul><li data-line="13">HEAD 记录所有更改记录</li><li data-line="14">logs/ref 下存储本地与远程分支的更改记录</li></ul></li><li data-line="15">objects 对象<ul><li data-line="16">2 位目录名/38 位文件名 ，提高效率</li><li data-line="17">blob 代码文件</li><li data-line="18">tree文件</li><li data-line="19">commit文件</li><li data-line="20">tag 重量级文件</li><li data-line="21">info/pack 压缩目录</li></ul></li><li data-line="22">refs 引用<br>- heads<br>- 分支名，指向 commit 的 hash 值<br>- tags<br>- 轻量级 tags，指向 commit<br>- 重量级 tags，指向 tag object 的 hash<br>- remote<br>- 记录每个分支最近一次 push 到远程对应的 commit<br>- stash 文件<br>- 记录 stash 的提交<br><span width="800" alt="left" src="lib/media/pasted-image-20230921151747.png" class="internal-embed media-embed image-embed is-loaded"><img alt="left" src="lib/media/pasted-image-20230921151747.png" style="width:800px;max-width:100%"></span></li></ul></div></div></div><div class="heading-wrapper"><h4 data-heading="对象" class="heading" id="对象"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>对象<div class="heading-after">...</div></h4><div class="heading-children"><div><ul><li data-line="0">blob：一次提交的文件一个 blob<ul><li data-line="1">git 追踪的是内容而不是文件<ul><li data-line="2">目录不同，但是内容一样，只会存在一份 blob</li><li data-line="3">git根据内容计算每一个文件的 SHA1 散列码</li><li data-line="4">版本变更是，git记录的是两个不同的文件内容，而不是内容之间的差异。</li></ul></li><li data-line="5">打包文件</li><li data-line="6">blob 内容 = header + content，header = 类型+空格+长度，计算 SHA-1</li></ul></li><li data-line="7">tree： 一次提交，所以目录一个 tree，包含各个文件的 blob。<ul><li data-line="8">tree-object 是提交时，所以文件的版本。对应文件系统的一个目录，tree = blob + tree</li></ul></li><li data-line="9">commit：一次提交一个 commit<ul><li data-line="10">记录作者、提交者、日期、日志消息。</li><li data-line="11">指向父提交，附属到一个 tree-obejct</li><li data-line="12">提交会生成 40 位完成的 SHA-1 hash，也可以提供至少前 4 位，一般 7 位。</li></ul></li><li data-line="13">tag<ul><li data-line="14">lightweight</li><li data-line="15">annotated<ul><li data-line="16">创建 对象</li></ul></li></ul></li><li data-line="17">存储优化<ul><li data-line="18">一般 loose格式</li><li data-line="19">git gc 或 push packfile（看情况）打包，差异性文件打包。只对最新文件做了全量处理，最老的都做了增量叠加</li></ul></li></ul></div><div><p><span width="1200" alt="left" src="lib/media/pasted-image-20230921152650.png" class="internal-embed media-embed image-embed is-loaded"><img alt="left" src="lib/media/pasted-image-20230921152650.png" style="width:1200px;max-width:100%"></span></p></div></div></div><div class="heading-wrapper"><h4 data-heading="引用" class="heading" id="引用"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>引用<div class="heading-after">...</div></h4><div class="heading-children"><div><ul><li data-line="0">可以指向任何对象，一般是指向提交对象</li><li data-line="1">分支名、标签名都是引用</li><li data-line="2">引用存储在.git/refs目录中</li><li data-line="3">特殊引用<ul><li data-line="4">HEAD：当前分支最近提交</li><li data-line="5">ORIG_HEAD：merge 与 reset之前的 HEAD</li><li data-line="6">FETCH_HEAD：其他分支 fetch 时，记录</li><li data-line="7">CHERRY_PICK_HEAD</li><li data-line="8">MERGE_HEAD：merge 时，其他分支的 head 记录在MERGE_HEAD</li><li data-line="9">REBASE_HEAD：变基信息，指向当前，被整合的commit的hashkey信息</li></ul></li></ul></div></div></div><div class="heading-wrapper"><h4 data-heading="状态机" class="heading" id="状态机"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>状态机<div class="heading-after">...</div></h4><div class="heading-children"><div><ul><li data-line="0">被忽律的（Ignored）<ul><li data-line="1">gitignore<ul><li data-line="2">*<em>/</em>.txt`</li></ul></li></ul></li><li data-line="3">未追踪的（Untracked）</li><li data-line="4">已修改（modified）</li><li data-line="5">已暂存（staged）</li><li data-line="6">已提交/未改变（committed/unmodified）<br><span width="600" alt="left" src="lib/media/pasted-image-20230921152833.png" class="internal-embed media-embed image-embed is-loaded"><img alt="left" src="lib/media/pasted-image-20230921152833.png" style="width:600px;max-width:100%"></span></li></ul></div></div></div></div></div><div class="heading-wrapper"><h2 data-heading="场景使用" class="heading" id="场景使用"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>场景使用<div class="heading-after">...</div></h2><div class="heading-children"><div class="heading-wrapper"><h4 data-heading="初始化" class="heading" id="初始化"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>初始化<div class="heading-after">...</div></h4><div class="heading-children"><div><p><code>git init</code> 初始化.git目录。此时 HEAD虽然指向refs/heads/master，但是 master 没有创建。<br><span width="1000" alt="left" src="lib/media/pasted-image-20230921152927.png" class="internal-embed media-embed image-embed is-loaded"><img alt="left" src="lib/media/pasted-image-20230921152927.png" style="width:1000px;max-width:100%"></span></p></div><div><p><code>git add --all</code> 添加， <code>git add -i</code> 交互<br><span width="1000" alt="left" src="lib/media/pasted-image-20230921152948.png" class="internal-embed media-embed image-embed is-loaded"><img alt="left" src="lib/media/pasted-image-20230921152948.png" style="width:1000px;max-width:100%"></span></p></div><div><p><code>git clone origin/xx.git</code> 克隆远程仓库</p></div><div><p><code>git commit -m</code> '初始化'<br><span width="1000" alt="left" src="lib/media/pasted-image-20230921153030.png" class="internal-embed media-embed image-embed is-loaded"><img alt="left" src="lib/media/pasted-image-20230921153030.png" style="width:1000px;max-width:100%"></span></p></div><div><p><code>.gitignore</code> 忽略当前目录下，某些文件</p></div><div><p><code>git checkout -b dev</code> 创建 dev，并切换到 dev<br><code>git switch -c dev</code>，创建并切换到 dev分支<br><span width="1600" alt="left" src="lib/media/pasted-image-20230921153125.png" class="internal-embed media-embed image-embed is-loaded"><img alt="left" src="lib/media/pasted-image-20230921153125.png" style="width:1600px;max-width:100%"></span></p></div><div><p><code>git config</code> 三级目录</p></div><div><ul><li data-line="0"><code>git config -a</code> .git/config目录</li><li data-line="1"><code>git config -e --global</code> ~/.gitconfig</li><li data-line="2"><code>git config -e --system</code> /etc/gitconfig</li></ul></div><div><p><code>git fetch</code> 拉取所以目录最新<br><span width="1600" alt="left" src="lib/media/pasted-image-20230921153208.png" class="internal-embed media-embed image-embed is-loaded"><img alt="left" src="lib/media/pasted-image-20230921153208.png" style="width:1600px;max-width:100%"></span></p></div><div><p><code>git stash</code> 暂存</p></div><div><ul><li data-line="0"><code>save</code>, <code>list</code>, <code>apply</code></li><li data-line="1"><code>git stash save --include-untracked</code> 包含缓存区，untrached 的文件</li><li data-line="2"><code>git stash apply --index</code> 同时将工作区和暂存区中的内容进行恢复<br><span width="1600" alt="left" src="lib/media/pasted-image-20230921153316.png" class="internal-embed media-embed image-embed is-loaded"><img alt="left" src="lib/media/pasted-image-20230921153316.png" style="width:1600px;max-width:100%"></span></li></ul></div></div></div><div class="heading-wrapper"><h4 data-heading="查看" class="heading" id="查看"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>查看<div class="heading-after">...</div></h4><div class="heading-children"><div><p><code>git status</code> 检查缓存区哪些变更没有 add，哪些变更没有commit。</p></div><div><p><code>git log</code> 目录操作日志</p></div><div><ul><li data-line="0"><code>git log --stat</code> 统计信息</li><li data-line="1"><code>git log --pretty=oneline</code> 显示一行</li><li data-line="2"><code>git log --pretty=format:"%h - %an, %ar : %s"</code> 可以显示短hash、作者、多长时间以前、提交说明。</li><li data-line="3"><code>git log --oneline --abbrev-commit --graph</code> 看到结构树</li><li data-line="4"><code>git log --abbrev-commit master ..feature/001</code> 后者与前者落后多上个 commit</li><li data-line="5"><code>git log --abbrev-commit feature/001..master</code> 前者领先落后多少个 commit</li></ul></div><div><p><code>git reflog</code> 全部 commit，而不是当前分支的树<br><code>git show</code> 查看各种对象，引用等</p></div><div><ul><li data-line="0">git show master/HEAD/xxxx 查看 master指向那个 commit</li><li data-line="1">git show HEAD~2 倒置前几个提交</li></ul></div><div><p><code>git diff</code>（只能产看 tracked 的文件）</p></div><div><ul><li data-line="0"><code>git diff</code>：工作区和暂存区</li><li data-line="1"><code>git diff --cached</code>：暂存区和仓库</li><li data-line="2"><code>git diff HEAD</code>：工作区和仓库</li><li data-line="3"><code>git diff feature/001 master</code>：两个分支之间的差异</li><li data-line="4"><code>git diff HEAD HEAD^</code>：最近两次提交之间的差异<br><span width="400" alt="left" src="lib/media/pasted-image-20230921153451.png" class="internal-embed media-embed image-embed is-loaded"><img alt="left" src="lib/media/pasted-image-20230921153451.png" style="width:400px;max-width:100%"></span></li></ul></div><div><p><code>git branch</code> 查看分支</p></div><div><ul><li data-line="0"><code>--list</code></li><li data-line="1"><code>--all</code></li><li data-line="2"><code>--remote</code></li></ul></div><div><p><code>git bisect</code> 二分查找</p></div><div><ul><li data-line="0"><code>git bisect start h e</code>：开始二分查找git</li><li data-line="1"><code>bisect bad</code>：标注当前这个commit是有bug的git</li><li data-line="2"><code>biset good v1.0.0</code>：用tag来标注说从上一次哪个上线为止，是没有bug的，就是那个tag对应的commit之前都是好的</li></ul></div></div></div><div class="heading-wrapper"><h4 data-heading="分支变更" class="heading" id="分支变更"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>分支变更<div class="heading-after">...</div></h4><div class="heading-children"><div><p><code>git reset</code> 变更分支指向 commit<br><span width="1000" alt="left" src="lib/media/pasted-image-20230921153748.png" class="internal-embed media-embed image-embed is-loaded"><img alt="left" src="lib/media/pasted-image-20230921153748.png" style="width:1000px;max-width:100%"></span></p></div><div><p><code>git reset --hard HEAD^（xx）</code> master指向上一个commit，抹掉暂存区和工作区<br><span width="1000" alt="left" src="lib/media/pasted-image-20230921153807.png" class="internal-embed media-embed image-embed is-loaded"><img alt="left" src="lib/media/pasted-image-20230921153807.png" style="width:1000px;max-width:100%"></span></p></div><div><p><code>git reset --mixed HEAD^（xx）</code> master指向上一个commit，抹掉暂存区<br><span width="1000" alt="left" src="lib/media/pasted-image-20230921153822.png" class="internal-embed media-embed image-embed is-loaded"><img alt="left" src="lib/media/pasted-image-20230921153822.png" style="width:1000px;max-width:100%"></span></p></div><div><p><code>git reset --soft HEAD^（xx）</code> master指向上一个commit，但是暂存区和工作区内容不变<br><span width="1000" alt="left" src="lib/media/pasted-image-20230921153838.png" class="internal-embed media-embed image-embed is-loaded"><img alt="left" src="lib/media/pasted-image-20230921153838.png" style="width:1000px;max-width:100%"></span></p></div><div><ul><li data-line="0"><code>git branch -u origin/serverfix</code> 让本地分支 track指定远程分支<ul><li data-line="1"><code>git branch -vv</code> 查看每个本地分支 track 的远程分支</li><li data-line="2"><code>git branch -d dev</code> 删除 dev分支</li></ul></li><li data-line="3"><code>git fetch origin</code> 拉取所以远程分支到最新</li><li data-line="4"><code>git pull --rebase</code> 变基式合并</li><li data-line="5"><code>git rebase -i HEAD~3</code> 编辑提交<br>- <code>pick</code>：保留该commit（缩写:p）<br>- <code>reword</code>：保留该commit，但我需要修改该 commit的注释（缩写:r）<br>- <code>edit</code>：保留该commit, 但我要停下来修改该提交(不仅仅修改注释)（缩写:e）<br>- <code>squash</code>：将该commit和前一个commit合并（缩写:s）<br>- <code>fixup</code>：将该commit和前一个commit合并，但我不要保留该提交的注释信息（缩写:f）<br>- <code>exec</code>：执行shell命令（缩写:x）<br>- <code>drop</code>：我要丢弃该commit（缩写:d）<br><span width="1600" alt="left" src="lib/media/pasted-image-20230921154105.png" class="internal-embed media-embed image-embed is-loaded"><img alt="left" src="lib/media/pasted-image-20230921154105.png" style="width:1600px;max-width:100%"></span></li></ul></div></div></div><div class="heading-wrapper"><h4 data-heading="提交" class="heading" id="提交"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>提交<div class="heading-after">...</div></h4><div class="heading-children"><div><ul><li data-line="0"><code>git commit -m</code> 描述提交信息</li><li data-line="1"><code>git cherry-pick</code> 先后 pick m 2, b2~b3的提交<br><span width="1600" alt="left" src="lib/media/pasted-image-20230925101310.png" class="internal-embed media-embed image-embed is-loaded"><img alt="left" src="lib/media/pasted-image-20230925101310.png" style="width:1600px;max-width:100%"></span></li></ul></div></div></div><div class="heading-wrapper"><h4 data-heading="合并" class="heading" id="合并"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>合并<div class="heading-after">...</div></h4><div class="heading-children"><div><p><code>git merge dev</code> 当前分支合并 dev<br>有两种 merge。<br><code>ff</code>：如果合并分支的最后 Commit，在被合并分支 Commit 的祖先节点上，那么，直接把分支指向从最新 Commit 即可。<br><span width="1600" alt="left" src="lib/media/pasted-image-20230921155141.png" class="internal-embed media-embed image-embed is-loaded"><img alt="left" src="lib/media/pasted-image-20230921155141.png" style="width:1600px;max-width:100%"></span><br><code>3w</code>：如果合并分支的最后 Commit，不在被合并分支 Commit 的祖先节点上，则需要想三叉路口一样，进行合并<br><span width="1600" alt="left" src="lib/media/pasted-image-20230921155301.png" class="internal-embed media-embed image-embed is-loaded"><img alt="left" src="lib/media/pasted-image-20230921155301.png" style="width:1600px;max-width:100%"></span></p></div></div></div><div class="heading-wrapper"><h4 data-heading="回退合并" class="heading" id="回退合并"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>回退合并<div class="heading-after">...</div></h4><div class="heading-children"><div><ul><li data-line="0"><code>git merge --abort</code> 合并过程中，不想合并</li><li data-line="1"><code>git reset --hard HEAD^</code> 合并之后，没有推送，不想合并</li><li data-line="2"><code>git revert -m 1 HEAD</code> 远程推送之后，恢复最后一次提交的代码<br><span width="1600" alt="left" src="lib/media/pasted-image-20230921154409.png" class="internal-embed media-embed image-embed is-loaded"><img alt="left" src="lib/media/pasted-image-20230921154409.png" style="width:1600px;max-width:100%"></span></li></ul></div></div></div><div class="heading-wrapper"><h4 data-heading="推送" class="heading" id="推送"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>推送<div class="heading-after">...</div></h4><div class="heading-children"><div><ul><li data-line="0"><code>git push -u origin</code> 分支名称</li><li data-line="1"><code>git push --set-upstream origin</code> 分支名称 推送并创建</li><li data-line="2"><code>git pull = git fetch + git merge origin/xx</code> (会自动 fetch)</li></ul></div></div></div></div></div><div class="heading-wrapper"><h2 data-heading="底层命令" class="heading" id="底层命令"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>底层命令<div class="heading-after">...</div></h2><div class="heading-children"><div><ul><li data-line="0"><code>git hash-object --stdin</code> 计算 hash 值</li><li data-line="1"><code>git update-index -add new.txt</code> 将文件放入暂存区</li><li data-line="2"><code>git read-tree</code> 将存库的文件引用，写到暂存区</li><li data-line="3"><code>git write-tree</code> 将暂存区的文件，写 tree</li><li data-line="4"><code>git commit-tree xx</code> 提交文件</li><li data-line="5"><code>git ls-files -s</code> 查看版本库文件名</li><li data-line="6"><code>git ls-files --stage</code> 查看索引区文件</li><li data-line="7"><code>git cat-file -p</code> 查看版本库文件内容</li><li data-line="8"><code>git update-ref xx</code> xx 更新指针引用</li></ul></div></div></div><div class="heading-wrapper"><h2 data-heading="方法论" class="heading" id="方法论"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>方法论<div class="heading-after">...</div></h2><div class="heading-children"><div class="heading-wrapper"><h4 data-heading="规范" class="heading" id="规范"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>规范<div class="heading-after">...</div></h4><div class="heading-children"><div><p>分支名</p></div><div><ul><li data-line="0">master 主分支，一般保护分支，不允许直接pull</li><li data-line="1">feature 用来开发一个分支</li><li data-line="2">hotfix 紧急线上修复</li><li data-line="3">bugfix 非紧急修复<br>使用/隔开，在.git底层目录中，也生成“feature/add_xx”这种结构。</li></ul></div></div></div><div class="heading-wrapper"><h4 data-heading="工作流" class="heading" id="工作流"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>工作流<div class="heading-after">...</div></h4><div class="heading-children"><div><p>集中式工作流（2 人）。直接 master 分支开发，不涉及 code review 什么的</p></div><div class="heading-wrapper"><h5 data-heading="功能分支工作流。" class="heading" id="功能分支工作流。"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>功能分支工作流。<div class="heading-after">...</div></h5><div class="heading-children"><div><p><strong>git flow</strong>（版本稳定的中小型项目）</p></div><div><ul><li data-line="0">master（发布）</li><li data-line="1">relesase（qa测试）</li><li data-line="2">develop（继承测试）</li><li data-line="3">feature/xx（功能开发）<br><span width="1000" alt="left" src="lib/media/pasted-image-20230921154745.png" class="internal-embed media-embed image-embed is-loaded"><img alt="left" src="lib/media/pasted-image-20230921154745.png" style="width:1000px;max-width:100%"></span></li></ul></div><div><p><strong>github flow</strong><br>github 推出的较为简单个工作流。可基于分支，也可基于 fork 库。侧重点在敏捷开发与CICD集成<br><span width="1000" alt="left" src="lib/media/pasted-image-20230921154803.png" class="internal-embed media-embed image-embed is-loaded"><img alt="left" src="lib/media/pasted-image-20230921154803.png" style="width:1000px;max-width:100%"></span></p></div><div><p><strong>gitlab flow</strong><br>gitlab 推出，结合 gitflow 与 github flow。有两种模式<br>基于环境分支的流程：<br><span alt="Pasted image 20230921154814.png" src="lib/media/pasted-image-20230921154814.png" class="internal-embed media-embed image-embed is-loaded"><img alt="Pasted image 20230921154814.png" src="lib/media/pasted-image-20230921154814.png"></span><br>基于稳定分支的flow<br><span width="1000" alt="left" src="lib/media/pasted-image-20230921154822.png" class="internal-embed media-embed image-embed is-loaded"><img alt="left" src="lib/media/pasted-image-20230921154822.png" style="width:1000px;max-width:100%"></span></p></div><div><p><strong>轻舟模型</strong><br>轻舟的 flow 与前三者都不一样。<br><span width="1000" alt="left" src="lib/media/pasted-image-20230921154836.png" class="internal-embed media-embed image-embed is-loaded"><img alt="left" src="lib/media/pasted-image-20230921154836.png" style="width:1000px;max-width:100%"></span></p></div></div></div></div></div></div></div><div class="heading-wrapper"><h2 data-heading="引用文件" class="heading" id="引用文件"><div class="heading-before"></div><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle" style="width:24px;max-width:100%"><path d="M3 8L12 17L21 8"></path></svg></div>引用文件<div class="heading-after">...</div></h2><div class="heading-children"><div><p>流程全景图：<a data-tooltip-position="top" aria-label="https://whimsical.com/git-SBaowM8vJZgQ4mzzgvuZET" rel="noopener" class="external-link" href="https://whimsical.com/git-SBaowM8vJZgQ4mzzgvuZET" target="_blank">Git相关</a></p></div><div class="mod-footer"></div></div></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-gutter"><div class="clickable-icon sidebar-collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><path d="M21 3H3C1.89543 3 1 3.89543 1 5V19C1 20.1046 1.89543 21 3 21H21C22.1046 21 23 20.1046 23 19V5C23 3.89543 22.1046 3 21 3Z"></path><path d="M10 4V20"></path><path d="M4 7H7"></path><path d="M4 10H7"></path><path d="M4 13H7"></path></svg></div></div><div class="sidebar-container"><div class="sidebar-sizer"><div class="sidebar-content-positioner"><div class="sidebar-content"><div class="graph-view-wrapper"><div class="sidebar-section-header">Interactive Graph</div><div class="graph-view-placeholder"><div class="graph-view-container"><div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div><canvas id="graph-canvas" width="512px" height="512px"></canvas></div></div></div><div class="tree-container outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></svg></button></div><div class="tree-scroll-area"><div class="tree-item" data-depth="1"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#git分享"><span class="tree-item-title"><p>git分享</p></span></a></div><div class="tree-item-children"><div class="tree-item mod-collapsible" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#底层结构"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><p>底层结构</p></span></a></div><div class="tree-item-children"><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#逻辑结构"><span class="tree-item-title"><p>逻辑结构</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#物理目录"><span class="tree-item-title"><p>物理目录</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#对象"><span class="tree-item-title"><p>对象</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#引用"><span class="tree-item-title"><p>引用</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#状态机"><span class="tree-item-title"><p>状态机</p></span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-collapsible" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#场景使用"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><p>场景使用</p></span></a></div><div class="tree-item-children"><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#初始化"><span class="tree-item-title"><p>初始化</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#查看"><span class="tree-item-title"><p>查看</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#分支变更"><span class="tree-item-title"><p>分支变更</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#提交"><span class="tree-item-title"><p>提交</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#合并"><span class="tree-item-title"><p>合并</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#回退合并"><span class="tree-item-title"><p>回退合并</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#推送"><span class="tree-item-title"><p>推送</p></span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#底层命令"><span class="tree-item-title"><p>底层命令</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-collapsible" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#方法论"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><span class="tree-item-title"><p>方法论</p></span></a></div><div class="tree-item-children"><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#规范"><span class="tree-item-title"><p>规范</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="4"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#工作流"><span class="tree-item-title"><p>工作流</p></span></a></div><div class="tree-item-children"></div></div><div class="tree-item" data-depth="5"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#功能分支工作流。"><span class="tree-item-title"><p>功能分支工作流。</p></span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item" data-depth="2"><div class="tree-item-contents"><a class="internal-link tree-item-link" href="#引用文件"><span class="tree-item-title"><p>引用文件</p></span></a></div><div class="tree-item-children"></div></div></div></div></div></div></div></div></div></div></div></div></body></html>